## 基于DFT辅助机器学习的铁基双金属硫属化合物磁性发现

patir@mtu.edu 

#### 新的磁性材料形式

- 铁基硫族化合物因其有趣的磁性行为在理论上和实验上得到了广泛的研究
- 报道了不同硫元的铁磁性、铁磁性和反铁磁性。
- 通过改变**金属元素和硫族元素**来改变过渡金属硫族元素的元素组成，可能会揭示一种新的磁性材料形式。

- 使用DFT和实验数据训练的机器学习模型



#### 数据集

- 使用密度泛函理论(DFT)计算生成
- 一个包含**4348种**铁基双金属硫属化合物FexAyB组成构型的结构数据集

#### 训练算法

- 算法：

  - 线性回归
  - 支持向量回归
  - 随机森林
  - 决策树
  - k近邻（简单，舍去）
  - 极端梯度增强（未了解，舍去）
  - 人工神经网络（复杂，舍去）

- 模型评估改进方法：

  十倍交叉验证和网格搜索，确定最佳模型及其参数，统计精确度得分

- 预测：双金属硫属化合物中的磁性

#### 创建数据集步骤

- 采用了DFT21计算的第一原则

- 首先构建了一个由两个Fe原子和两个S原子组成的六方(空间群p63/mmc)铁-硫化物(FeS)的原始细胞

- 利用优化后的晶格参数，我们将六方FeS的原始单元扩展为更大的单元，**由16个Fe和16个s原子组成**

- **取代技术**制备了不同原子组成的双金属硫族化合物(FexAyB)

- ##### 取代后的新材料结构

  - 铁基双金属硫属化合物
  - FexAyB
  - A代表Ni、Co、Cr、Mn, 取代部分Fe原子位置
  - B代表S、Se、Te,  取代全部S原子位置
  - x、y分别代表各自元素的浓度（取决于在铁原子原位置上有多少铁原子被取代）
  
- 根据取代的数量和位置，生成了4348个不同组成的双金属硫族化合物结构。（特征值）

- 随后，进行自旋极化DFT计算，计算每种成分的磁化强度（预测值）

- 获得用于开发机器学习模型的数据集

- ##### 特征值的选择

  - 选择12个特征值
  - 其中8个特征值描述了金属元素的浓度，如金属Fe, Ni, Co, Cr, Mn，以及硫化物元素S, Se和Te。
  - 例如，在Fe0.6875Ni0.3125Se中，八个描述符为0.6875,0.3125,0,0,0,1,0,0表示每种元素的浓度，用于可能的双金属硫族化合物配置
  - 剩下4个特征值描述了替换位点S1、S2、S3和S4的位置。这些描述符的选择是由于取代硫族化合物的磁顺序也依赖于取代位点。（根据s1234的取代情况可以推出硫族化合物的取代位点，从而可以做到减少一个特征值，即给数据降一维。）
  
- 数据按85:15的比例随机分为训练集和测试集



#### 模型选择和算法训练步骤

- scikit-learn（TensorFlow Keras API 深度学习太复杂不搞）
  - 线性回归
  - 支持向量回归
  - 随机森林
  - 决策树
- 寻找合适模型方法：十倍交叉验证
- 寻找合适模型参数算法：网格搜索
- 算力足够时：可将上述两种合并，模型和参数通过伪笛卡尔积同时比较各种不同种类模型不同参数的模型
- 先用元估计器找到各个模型的最佳参数，再用交叉验证寻找最佳模型时会发生数据泄露，所以使用同一训练集时上述两个步骤不能分步进行，得用管道函数同时进行。
- 使用带有交叉验证的网格搜索并嵌套交叉验证



#### 预测评估

- 评估指标：
  1. 均方误差(MSE)   方差
  2. 平均绝对误差(MAE)  标准差
  3. 决定系数(R2) 
- R2是回归模型中的一种统计度量，它表示从自变量中可预测的因变量方差的比例.
- R2本身并不能衡量预测的准确性，我们将这个指标与MSE和MAE结合使用来衡量我们研究中使用的回归模型的性能。



#### 结果和结论

- 首先，我们对DFT数据集进行了一些探索性数据分析。结果表明，与含有Te的硫族化合物相比，含有S和Se的双金属硫族化合物具有更高的磁矩，揭示了FeS和FeSe表现出比FeTe更强的磁化能力。
- 此外，我们发现含有Cr和S的fe -硫族化合物比含有其他过渡金属元素(Ni、Co或Mn)和硫族元素(Se和Te)的fe -硫族化合物具有更高的磁矩。
- 当含有S或Se的硫属化合物中Cr或Mn浓度增加时，磁矩也明显增加。
- 此外，硫族化合物中过渡金属元素的**取代位**也会影响目标值(磁矩)。



#### 基础学习器和元学习器的十倍交叉验证结果

- 通过比较平均MSE、平均MAE和平均R2，发现RF（随机森林）模型表现良好。
- 除了LR方法外，所有模型都表现得相当好，这说明预测目标和特征关系更偏向为非线性关系
- 这些性能良好的模型随后被用于开发最终的堆叠模型。（即把线性回归模型去除）
- 用嵌套交叉验证，使用**各个基本模型的输出**来**训练**LR、RF和XGB，并重新计算平均MSE、平均MAE和平均R2
- 测试集验证结果：MSE、MAE和R2分别为1.655 (μ B)^2^、0.546 μB和0.922，与10倍交叉验证值1.29 (μ B)2、0.50 μ B和0.94相比，接近。有着较好的泛化性



#### 扩展所提出模型的适用性

- 之前模型参数的限制：
  - 预先定义了y(0.0625, 0.125, 0.1875, 0.25, 0.3125, 0.375, 0.4375, 0.5, 0.5625, 0.625)和x(=1−y)的固定值为1/16的倍数。
  - 描述符S1、S2、S3和S4都可以取0到4之间的整数值
- 开发广义算法，可以满足：
  - 将浓度y(或x)以百分比为约束 0<y<0.625
  - 还允许用户以百分比的形式选择原子位置S1、S2、S3和S4上取代原子的浓度
  - 算法计算输入特征y, x, S1, S2, S3和S4，以合适的形式馈送ML模型。而后得到预测值。

#### 总结

- 寻找比稀土元素磁体更便宜的新型磁性材料是近年来的重要课题，因为它们的应用范围从数据存储到汽车，从生物医学领域到绿色能源领域。对可能的替代磁性材料进行实验和计算研究既昂贵又耗时。

- 在这项工作中，我们使用了一个数据驱动的框架，这将加速发现新的磁性材料。

- 我们利用优化的FeS结构和取代技术设计了新的不同组成的双金属硫属化合物。

- 第一原理DFT用于生成训练和测试数据。

- 在训练和评估了几个机器学习模型之后，我们开发了一个堆叠的机器学习模型，它结合了几个表现最好的基础模型作为最终的预测工具。

  

- 在MSE、MAE和R2值分别为1.655 (μ B)2、0.546 μ B和0.922的情况下，该模型在独立dft测试数据上显示出较高的准确性。

- 我们还开发了一种通用算法，将我们的模型的适用性扩展到更大范围的输入。

- 预测数据显示，铁基双金属硫族化合物含有硫元S，过渡金属Cr浓度较高，磁矩高于其他构型，这与DFT数据一致。这项工作为发现一种由更便宜、更丰富的元素制成的新磁性材料提供了一种策略，这种材料最终将取代由稀土金属制成的昂贵的现有磁性材料。
